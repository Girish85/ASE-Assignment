<!--

/*
 *
 * Copyright 2015 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

-->

<!DOCTYPE html>
<html>
<head>
    <title>Google+ JavaScript Quickstart</title>
    <!-- JavaScript specific to this application that is not related to API
       calls -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" ></script>
    <meta name="google-signin-client_id" content="237999442735-og341j00p2nebdvj031i8qjkhd4q63f8.apps.googleusercontent.com"></meta>
</head>
<body background="background-24.jpg">
    <div><br/></div>
    <div id="Girish">
        <h1 style="text-align: center">Create Account</h1>
        <form>
            <pre>
            <h2 style="text-align: center;font-family: Arial;color: black">Email:<input type="email" placeholder="Enter your mail id" required></h2>
            <h2 style="text-align: center;font-family: Arial;color: black">Username:<input type="text" placeholder="Enter your username" required></h2>
            <h2 style="text-align: center;font-family: Arial;color: black">Password:<input type="password" placeholder="enter password" required></h2>
            <h2 style="text-align: center;font-family: Arial;color: black"><input type="submit" style="width: 100px;height: 50px;color: azure;background-color: cornflowerblue" value="Create Account"></h2>
                <h1>                                                          OR</h1>
            </pre>
        </form>
    </div>
<div id="gConnect" align="center">
    <div id="signin-button" style="align: center"></div>
</div>
<script>
    // This is called with the results from from FB.getLoginStatus().
    function statusChangeCallback(response) {
        console.log('statusChangeCallback');
        console.log(response);
        // The response object is returned with a status field that lets the
        // app know the current login status of the person.
        // Full docs on the response object can be found in the documentation
        // for FB.getLoginStatus().
        if (response.status === 'connected') {
            // Logged into your app and Facebook.
            testAPI();
        } else if (response.status === 'not_authorized') {
            // The person is logged into Facebook, but not your app.
            document.getElementById('status').innerHTML = 'Please log ' +
                'into this app.';
        } else {
            // The person is not logged into Facebook, so we're not sure if
            // they are logged into this app or not.
            document.getElementById('status').innerHTML = 'Please log ' +
                'into Facebook.';
        }
    }

    // This function is called when someone finishes with the Login
    // Button.  See the onlogin handler attached to it in the sample
    // code below.
    function checkLoginState() {
        FB.getLoginStatus(function(response) {
            statusChangeCallback(response);
        });
    }

    window.fbAsyncInit = function() {
        FB.init({
            appId      : '1795601170761862',
            cookie     : true,  // enable cookies to allow the server to access
                                // the session
            xfbml      : true,  // parse social plugins on this page
            version    : 'v2.8' // use graph api version 2.8
        });

        // Now that we've initialized the JavaScript SDK, we call
        // FB.getLoginStatus().  This function gets the state of the
        // person visiting this page and can return one of three states to
        // the callback you provide.  They can be:
        //
        // 1. Logged into your app ('connected')
        // 2. Logged into Facebook, but not your app ('not_authorized')
        // 3. Not logged into Facebook and can't tell if they are logged into
        //    your app or not.
        //
        // These three cases are handled in the callback function.

        FB.getLoginStatus(function(response) {
            statusChangeCallback(response);
        });

    };

    // Load the SDK asynchronously
    (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

    // Here we run a very simple test of the Graph API after login is
    // successful.  See statusChangeCallback() for when this call is made.
    function testAPI() {
        console.log('Welcome!  Fetching your information.... ');
        FB.api('/me', function(response) {
            console.log('Successful login for: ' + response.name);
            document.getElementById('status').innerHTML =
                'Thanks for logging in, ' + response.name + '!';
        });
    }
</script>

<!--
  Below we include the Login Button social plugin. This button uses
  the JavaScript SDK to present a graphical Login button that triggers
  the FB.login() function when clicked.
-->
<pre>
                                                                                                                 <fb:login-button scope="public_profile,email" onlogin="checkLoginState();">
                                                                                                                 </fb:login-button></pre>

<div id="status" align="center">
</div>
<div id="authOps" style="display:none">
    <h2 style="text-align: center">You are now signed in to the app using Google+</h2>
    <form action="diet.html">
    <pre>                                                                                                   <button id="signOut" onclick="auth2.signOut()" style="width: 100px;height: 40px">Sign Out</button>         <input style="width: 100px;height: 40px" type="submit" name="sub" value="HOME">
    </pre></form>

    <!--<p>If the user chooses to disconnect, the app must delete all stored
    information retrieved from Google for the given user.</p>
<button id="disconnect" >Disconnect your Google account from this app</button>-->
    <!--<h2>Profile information</h2>
    <div id="profile"></div>-->

    <!--   <h2>User's friends that are visible to this app</h2>
       <div id="visiblePeople"></div>

      <h2>Authentication Logs</h2>
       <pre id="authResult"></pre>
   </div>
   <div id="loaderror">
       This section will be hidden by jQuery. If you can see this message, you
       may be viewing the file rather than running a web server.<br />
       The sample must be run from http or https. See instructions at
       <a href="https://developers.google.com/+/quickstart/javascript">
           https://developers.google.com/+/quickstart/javascript</a>.
   </div>-->
    <script type="text/javascript">
        var auth2 = {};
        var helper = (function() {
            return {
                /**
                 *
                 * Hides the sign in button and starts the post-authorization operations.
                 *
                 * @param {Object} authResult An Object which contains the access token and
                 *   other authentication information.
                 */
                onSignInCallback: function(authResult) {
                    $('#authResult').html('Auth Result:<br/>');
                    for (var field in authResult) {
                        $('#authResult').append(' ' + field + ': ' +
                            authResult[field] + '<br/>');
                    }
                    if (authResult.isSignedIn.get()) {
                        $('#authOps').show('slow');
                        $('#gConnect').hide();
                        helper.profile();
                        helper.people();
                    } else {
                        if (authResult['error'] || authResult.currentUser.get().getAuthResponse() == null) {
                            // There was an error, which means the user is not signed in.
                            // As an example, you can handle by writing to the console:
                            console.log('There was an error: ' + authResult['error']);
                        }
                        $('#authResult').append('Logged out');
                        $('#authOps').hide('slow');
                        $('#gConnect').show();
                    }

                    console.log('authResult', authResult);
                },

                /**
                 * Calls the OAuth2 endpoint to disconnect the app for the user.
                 */
                disconnect: function() {
                    // Revoke the access token.
                    auth2.disconnect();
                },

                /**
                 * Gets and renders the list of people visible to this app.
                 */
                people: function() {
                    gapi.client.plus.people.list({
                        'userId': 'me',
                        'collection': 'visible'
                    }).then(function(res) {
                        var people = res.result;
                        $('#visiblePeople').empty();
                        $('#visiblePeople').append('Number of people visible to this app: ' +
                            people.totalItems + '<br/>');
                        for (var personIndex in people.items) {
                            person = people.items[personIndex];
                            $('#visiblePeople').append('<img src="' + person.image.url + '">');
                        }
                    });
                },

                /**
                 * Gets and renders the currently signed in user's profile data.
                 */
                profile: function(){
                    gapi.client.plus.people.get({
                        'userId': 'me'
                    }).then(function(res) {
                        var profile = res.result;
                        console.log(profile);
                        $('#profile').empty();
                        $('#profile').append(
                            $('<p><img src=\"' + profile.image.url + '\"></p>'));
                        $('#profile').append(
                            $('<p>Hello ' + profile.displayName + '!<br />Tagline: ' +
                                profile.tagline + '<br />About: ' + profile.aboutMe + '</p>'));
                        if (profile.emails) {
                            $('#profile').append('<br/>Emails: ');
                            for (var i=0; i < profile.emails.length; i++){
                                $('#profile').append(profile.emails[i].value).append(' ');
                            }
                            $('#profile').append('<br/>');
                        }
                        if (profile.cover && profile.coverPhoto) {
                            $('#profile').append(
                                $('<p><img src=\"' + profile.cover.coverPhoto.url + '\"></p>'));
                        }
                    }, function(err) {
                        var error = err.result;
                        $('#profile').empty();
                        $('#profile').append(error.message);
                    });
                }
            };
        })();

        /**
         * jQuery initialization
         */
        $(document).ready(function() {
            $('#disconnect').click(helper.disconnect);
            $('#loaderror').hide();
            if ($('meta')[0].content == 'YOUR_CLIENT_ID') {
                alert('This sample requires your OAuth credentials (client ID) ' +
                    'from the Google APIs console:\n' +
                    '    https://code.google.com/apis/console/#:access\n\n' +
                    'Find and replace YOUR_CLIENT_ID with your client ID.'
                );
            }
        });

        /**
         * Handler for when the sign-in state changes.
         *
         * @param {boolean} isSignedIn The new signed in state.
         */
        var updateSignIn = function() {
            console.log('update sign in state');
            if (auth2.isSignedIn.get()) {
                console.log('signed in');
                helper.onSignInCallback(gapi.auth2.getAuthInstance());
            }else{
                console.log('signed out');
                helper.onSignInCallback(gapi.auth2.getAuthInstance());
            }
        }

        /**
         * This method sets up the sign-in listener after the client library loads.
         */
        function startApp() {
            gapi.load('auth2', function() {
                gapi.client.load('plus','v1').then(function() {
                    gapi.signin2.render('signin-button', {
                        scope: 'https://www.googleapis.com/auth/plus.login',
                        fetch_basic_profile: false });
                    gapi.auth2.init({fetch_basic_profile: false,
                        scope:'https://www.googleapis.com/auth/plus.login'}).then(
                        function (){
                            console.log('init');
                            auth2 = gapi.auth2.getAuthInstance();
                            auth2.isSignedIn.listen(updateSignIn);
                            auth2.then(updateSignIn);
                        });
                });
            });
        }
    </script>
    <script src="https://apis.google.com/js/client:platform.js?onload=startApp"></script>
</body>
</html>
